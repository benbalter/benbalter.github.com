// Optimized stylesheet for Astro build
// This imports only necessary Bootstrap components to reduce bundle size

// 1. Include functions first (required for everything)
@import 'bootstrap/scss/functions';

// 2. Custom Bootstrap variables (must be defined before importing other Bootstrap)
$header-path: "/assets/img/header.jpg";
$blue: #337ab7;
$enable-shadows: true;
$enable-gradients: true;
$tooltip-max-width: 350px;
$color-mode-type: media-query;

// 3. Include variable defaults
@import 'bootstrap/scss/variables';
@import 'bootstrap/scss/variables-dark';

// 4. Include maps (required for utilities)
@import 'bootstrap/scss/maps';

// 5. Include mixins
@import 'bootstrap/scss/mixins';

// 6. Layout & components - Only import what we actually use
@import 'bootstrap/scss/root';
@import 'bootstrap/scss/reboot';
@import 'bootstrap/scss/type';
@import 'bootstrap/scss/images';
@import 'bootstrap/scss/containers';
@import 'bootstrap/scss/grid';

// Skip unused components to reduce bundle size:
// - buttons (we style our own links)
// - forms (no forms on static blog)
// - accordion, alert, badge, breadcrumb, button-group, card, carousel, 
//   close, dropdown, list-group, modal, nav, navbar, offcanvas, pagination, 
//   placeholders, popover, progress, spinners, toasts, tooltip

// Include only what we need:
@import 'bootstrap/scss/tables';     // For markdown tables
@import 'bootstrap/scss/transitions'; // For smooth interactions

// 7. Helpers
@import 'bootstrap/scss/helpers';

// Add minimal utility classes we actually use in pages
.justify-content-center {
    justify-content: center !important;
}

.align-items-center {
    align-items: center !important;
}

.text-center {
    text-align: center !important;
}

.text-start {
    text-align: left !important;
}

.text-end {
    text-align: right !important;
}

.mb-3 {
    margin-bottom: 1rem !important;
}

.mt-2 {
    margin-top: 0.5rem !important;
}

// Text alignment utilities for responsive sizes
@media (min-width: 576px) {
    .text-sm-center {
        text-align: center !important;
    }
    .text-sm-start {
        text-align: left !important;
    }
}

// Skip the full utilities API to reduce bundle size significantly
// Component-specific styles will handle their own utility needs

// Syntax highlighting styles
@import '../../sass/highlighting';

// Dark and light mode syntax highlighting colors
// Each partial now contains its own @media query wrapper
@import '../../sass/base16.dark';
@import '../../sass/base16.light';

// Typography improvements
body {
    font-size: 1.05rem;
    line-height: 1.7;
    font-weight: 400;
}

h1, h2, h3, h4, h5, h6 {
    font-weight: 600;
    line-height: 1.3;
    margin-top: 1.5em;
    margin-bottom: 0.75em;
}

h1 { font-size: 2.5rem; }
h2 { font-size: 2rem; }
h3 { font-size: 1.5rem; }
h4 { font-size: 1.25rem; }

p {
    margin-bottom: 1.25rem;
}

// Improve code block styling
pre {
    padding: 1rem;
    background-color: var(--bs-secondary-bg);
    border-radius: var(--bs-border-radius);
    margin: 1.5rem 0;
    overflow-x: auto;
}

code {
    font-size: 0.9em;
    padding: 0.2em 0.4em;
    background-color: var(--bs-secondary-bg);
    border-radius: 0.25rem;
}

pre code {
    padding: 0;
    background-color: transparent;
}

// Improve link styling
a {
    color: var(--bs-link-color);
    text-decoration: none;
    transition: color 0.15s ease-in-out;
}

a:hover {
    color: var(--bs-link-hover-color);
    text-decoration: underline;
}

// Table improvements
table {
    margin: 1.5rem 0;
}

th, td {
    padding: 0.75rem;
}

// Custom styles
abbr[data-bs-original-title] {
    // Apply abbr styles directly
    text-decoration: underline;
    text-decoration-style: dotted;
    cursor: help;
    text-decoration-color: inherit;
}

.footnotes {
    font-size: 0.875rem;
    border-top: 1px solid var(--bs-border-color);
    padding-top: 1rem;
    margin-top: 3rem;
}

.footnotes::before {
    content: "Notes:";
    margin-bottom: 1rem;
    display: block;
    font-weight: 600;
}

.footnotes ol {
    padding-left: 1rem;
}

.footnotes ol li p {
    margin-bottom: 0.5rem;
}

.hero-unit {
    background-image: url($header-path);
    background-size: cover;
    background-position: top left;
    height: 400px;
    margin-bottom: 2rem;
}

.gist {
    .gist-it-gist .gist-file .gist-data,
    .gist-meta {
        background: #fcfcff !important;
    }

    .pl-c {
        color: #757775 !important;
    }

    .pl-c1 {
        color: #007faa !important;
    }
}

.min-y-5 {
    min-height: 5em;
}

blockquote {
    border-left: 5px solid var(--bs-gray-400);
    padding-left: 1.5rem;
    margin: 1.5rem 0;
    color: var(--bs-secondary-color);
    font-style: italic;
}

.avatar {
    max-width: 100%;
    height: auto;
    border-radius: var(--bs-border-radius);
}

// Footer link accessibility fix
// Bootstrap's link-secondary uses gray-600 (#6c757d) which has ~4.48:1 contrast ratio
// against white, below WCAG AA requirement of 4.5:1. Using gray-700 (#495057) provides
// ~7.13:1 contrast ratio, meeting both WCAG AA and AAA requirements.
footer .link-secondary,
nav .border-top .link-secondary {
    color: var(--bs-gray-700) !important;

    &:hover,
    &:focus {
        color: var(--bs-gray-800) !important;
    }
}

// Dark mode footer link adjustment
@media (prefers-color-scheme: dark) {
    footer .link-secondary,
    nav .border-top .link-secondary {
        color: var(--bs-gray-400) !important;

        &:hover,
        &:focus {
            color: var(--bs-gray-300) !important;
        }
    }
    
    blockquote {
        border-left-color: var(--bs-gray-600);
    }
}
