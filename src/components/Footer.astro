---
/**
 * Footer Component
 * 
 * Site-wide footer with navigation links and social connections.
 * Uses Bootstrap nav utilities and extends with minimal custom styles.
 * Matches the structure and styling of the Jekyll footer.
 * 
 * Uses inline SVG icons via the Icon component for better performance
 * (eliminates the ~77KB FontAwesome JS bundle).
 */

import { footerLinks, contactLinks } from '../config';
import Icon from './Icon.astro';
---

<footer class="mt-5 pt-4 footer-divider" transition:persist>
  <nav aria-label="Footer navigation" class="footer-nav">
    <div class="d-flex justify-content-between px-2 py-3 mb-4 flex-wrap">
      <ul class="nav contact-links">
        {contactLinks.map((link) => (
          <li class="nav-item">
            <a 
              href={link.url} 
              aria-label={link.name}
              class="nav-link social-link"
              target="_blank"
              rel="noopener noreferrer me"
            >
              <Icon name={link.icon} title={link.name} />
            </a>
          </li>
        ))}
      </ul>
      
      <ul class="nav footer-links">
        {footerLinks.map((link) => (
          <li class="nav-item">
            <a href={link.url} class="nav-link link-secondary footer-link">
              {link.title}
            </a>
          </li>
        ))}
        
        <li class="nav-item">
          <a href="/feed.xml" aria-label="RSS Feed" class="nav-link social-link">
            <Icon name="rss" title="RSS Feed" />
          </a>
        </li>
      </ul>
    </div>
  </nav>
</footer>

<style lang="scss">
  /* Import Bootstrap nav component (scoped to this component) */
  @import 'bootstrap/scss/functions';
  @import 'bootstrap/scss/variables';
  @import 'bootstrap/scss/variables-dark';
  @import 'bootstrap/scss/maps';
  @import 'bootstrap/scss/mixins';
  @import 'bootstrap/scss/nav';
  
  /* Enhanced footer divider */
  .footer-divider {
    border-top: 2px solid rgba(var(--bs-primary-rgb, 13, 110, 253), 0.1);
    position: relative;
    
    &::before {
      content: '';
      position: absolute;
      top: -2px;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(var(--bs-primary-rgb, 13, 110, 253), 0.3) 50%,
        transparent
      );
    }
  }

  /* Reduce footer link sizes */
  .nav-link {
    font-size: 0.875rem;
    transition: all 0.2s ease;
  }
  
  /* Enhanced social link hover effects with mobile touch optimization */
  .social-link {
    position: relative;
    color: var(--bs-body-color);
    // Prevent accidental zoom on mobile
    touch-action: manipulation;
    // Ensure adequate touch target size
    min-height: 44px;
    min-width: 44px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    
    &:hover {
      color: var(--bs-primary);
    }
    
    /* Subtle background on hover - using proper stacking context */
    &::before {
      content: '';
      position: absolute;
      top: -4px;
      right: -4px;
      bottom: -4px;
      left: -4px;
      background: rgba(var(--bs-primary-rgb, 13, 110, 253), 0.1);
      border-radius: 50%;
      opacity: 0;
      transition: opacity 0.2s ease;
    }
    
    /* Enhanced touch area on mobile devices */
    @media (max-width: 767px) {
      &::before {
        top: -8px;
        right: -8px;
        bottom: -8px;
        left: -8px;
      }
    }
    
    /* Ensure icon stays above pseudo-element */
    :global(svg) {
      position: relative;
      z-index: 1;
    }
    
    &:hover::before {
      opacity: 1;
    }
    
    // Touch feedback for mobile
    &:active {
      color: var(--bs-primary);
      transform: translateY(1px);
      
      &::before {
        opacity: 1;
        background: rgba(var(--bs-primary-rgb, 13, 110, 253), 0.15);
      }
    }
  }
  
  /* Respect reduced motion preferences for transform animations */
  @media (prefers-reduced-motion: no-preference) {
    .social-link:hover {
      transform: translateY(-2px);
    }
  }
  
  /* Footer text links */
  .footer-link {
    position: relative;
    
    &::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 0;
      height: 1px;
      background: currentColor;
      transition: width 0.2s ease, left 0.2s ease;
    }
    
    &:hover::after {
      width: 80%;
      left: 10%;
    }
  }

  /* Responsive layout adjustments */
  @media (max-width: 768px) {
    .footer-nav > div {
      justify-content: center !important;
      flex-direction: column;
      text-align: center;
    }
    
    .contact-links,
    .footer-links {
      justify-content: center !important;
    }
  }
  
  /* Dark mode adjustments */
  @media (prefers-color-scheme: dark) {
    .footer-divider {
      border-top-color: rgba(var(--bs-primary-rgb, 13, 110, 253), 0.2);
      
      &::before {
        background: linear-gradient(
          90deg,
          transparent,
          rgba(var(--bs-primary-rgb, 13, 110, 253), 0.4) 50%,
          transparent
        );
      }
    }
  }
</style>
