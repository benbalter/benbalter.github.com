{"author":"Benjamin J. Balter","title":"WordPress Emphasis Plugin: Highlight and Permalink Text","excerpt":"One-click implementation of the New York Times open source emphasis script as a WordPress plugin which allows for highlighting and permalinking of text on a paragraph and sentence level.\n","layout":"post","category":["Technology"],"tags":["deep links","journalism","nyt","open source","plugin","wordpress"],"post_format":[],"url":"/2011/01/11/wordpress-emphasis-plugin/","date":"2011-01-11 00:00:00 -0500","id":"/2011/01/11/wordpress-emphasis-plugin","categories":["posts"],"next":"![][1]George Washington University recently released an [iPhone app][2] that allows students to look up the course schedule and each course's open/closed status as well as browse an interactive map of the campus. Naturally, upon installing the app, the first thing to do is to try and ferret out the underlying XML API that powers it, a simple enough task given [the right tools][3].\r\n\r\nBelow you can find the details on GW's course schedule and campus map API endpoints, as well as an API wrapper to interact with it written in PHP. Feel free to grab the code below, or fork and contribute in the [GitHub repo][4]. Cool data that deserves to be shared with the world, no doubt.\r\n\r\n\r\n\r\nCreative ideas on how best to leverage the information welcome in the [comments below][5].\r\n\r\n*Please Note: I am not a GW employee, nor is use of the API explicitly authorized by the University. The code below is provided \"as is\" solely for educational purposes. If for any reason you would like this page removed, please [contact me][6] immediately and I will do so.*\r\n\r\n* * *\r\n\r\n## Course Schedule\r\n\r\n1.  Departments \r\n    1.  Endpoint \r\n        1.  `http://my.gwu.edu/mod/pws/scheduleXML.cfm`\r\n    2.  Parameters \r\n        1.  `termCode=[YYYY][01=spring, 02=summer, 03=fall]`\r\n    3.  Returns\r\n    \r\n        &lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot; ?&gt;\r\n        &lt;departments&gt;\r\n            &lt;department&gt;\r\n                &lt;departmentcode&gt;&lt;![CDATA[ACCY]]&gt;&lt;/departmentcode&gt;\r\n                &lt;departmentname&gt;&lt;![CDATA[Accountancy]]&gt;&lt;/departmentname&gt;\r\n            &lt;/department&gt;\r\n            &lt;department&gt;\r\n                &lt;departmentcode&gt;&lt;![CDATA[AH]]&gt;&lt;/departmentcode&gt;\r\n                &lt;departmentname&gt;&lt;![CDATA[Art/Art History]]&gt;&lt;/departmentname&gt;\r\n            &lt;/department&gt;\r\n        &lt;/departments&gt;\r\n        \r\n\r\n2.  Courses \r\n    1.  Endpoint \r\n        1.  `http://my.gwu.edu/mod/pws/scheduleXML.cfm`\r\n    2.  Parameters \r\n        1.  `termCode=[YYYY][01=spring, 02=summer, 03=fall]`\r\n        2.  `deptCode=[Dept. Code]`\r\n    3.  Returns\r\n    \r\n        &lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot; ?&gt;\r\n            &lt;courses&gt;\r\n                &lt;course&gt;\r\n                    &lt;coursedepartment&gt;&lt;![CDATA[ACCY]]&gt;&lt;/coursedepartment&gt;\r\n                    &lt;coursenumber&gt;&lt;![CDATA[6101]]&gt;&lt;/coursenumber&gt;\r\n                    &lt;coursecrn&gt;&lt;![CDATA[55164]]&gt;&lt;/coursecrn&gt;\r\n                    &lt;coursetitle&gt;&lt;![CDATA[FinAcctingI:BasicFinStatements]]&gt;&lt;/coursetitle&gt;\r\n                    &lt;courseinstructor&gt;&lt;![CDATA[ Singleton, L]]&gt;&lt;/courseinstructor&gt;\r\n                    &lt;courselocation&gt;&lt;![CDATA[&lt;A HREF=&quot;http://www.gwu.edu/~map/building.cfm?BLDG=DUQUES&quot; target=&quot;_blank&quot; &gt;DUQUES&lt;/a&gt; 258]]&gt;&lt;/courselocation&gt;\r\n                    &lt;coursedays&gt;&lt;![CDATA[MW 06:10PM - 09:05PM]]&gt;&lt;/coursedays&gt;\r\n                    &lt;coursetime&gt;&lt;![CDATA[]]&gt;&lt;/coursetime&gt;\r\n                    &lt;coursestatus&gt;&lt;![CDATA[OPEN]]&gt;&lt;/coursestatus&gt;\r\n                    &lt;coursesection&gt;&lt;![CDATA[81]]&gt;&lt;/coursesection&gt;\r\n                    &lt;coursecredit&gt;&lt;![CDATA[1.50  ]]&gt;&lt;/coursecredit&gt;\r\n                &lt;/course&gt;\r\n                &lt;course&gt;\r\n                    &lt;coursedepartment&gt;&lt;![CDATA[ACCY]]&gt;&lt;/coursedepartment&gt;\r\n                    &lt;coursenumber&gt;&lt;![CDATA[6102]]&gt;&lt;/coursenumber&gt;\r\n                    &lt;coursecrn&gt;&lt;![CDATA[55165]]&gt;&lt;/coursecrn&gt;\r\n                    &lt;coursetitle&gt;&lt;![CDATA[Fin Accting II: FinAcc Choices]]&gt;&lt;/coursetitle&gt;\r\n                    &lt;courseinstructor&gt;&lt;![CDATA[ Tarpley, R]]&gt;&lt;/courseinstructor&gt;\r\n                    &lt;courselocation&gt;&lt;![CDATA[&lt;A HREF=&quot;http://www.gwu.edu/~map/building.cfm?BLDG=DUQUES&quot; target=&quot;_blank&quot; &gt;DUQUES&lt;/a&gt; 258]]&gt;&lt;/courselocation&gt;\r\n                    &lt;coursedays&gt;&lt;![CDATA[MW 06:10PM - 09:05PM]]&gt;&lt;/coursedays&gt;\r\n                    &lt;coursetime&gt;&lt;![CDATA[]]&gt;&lt;/coursetime&gt;\r\n                    &lt;coursestatus&gt;&lt;![CDATA[OPEN]]&gt;&lt;/coursestatus&gt;\r\n                    &lt;coursesection&gt;&lt;![CDATA[80]]&gt;&lt;/coursesection&gt;\r\n                    &lt;coursecredit&gt;&lt;![CDATA[1.50  ]]&gt;&lt;/coursecredit&gt;\r\n                &lt;/course&gt;\r\n            &lt;/courses&gt;\r\n        \r\n\r\n## Campus Map\r\n\r\n1.  Categories \r\n    1.  Endpoint \r\n        1.  ` http://citl.gwu.edu/iphonedev/maps/categories.xml `\r\n    2.  Returns\r\n    \r\n        &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;\r\n        &lt;categories xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;\r\n            &lt;category&gt;\r\n                &lt;categoryId&gt;1&lt;/categoryId&gt;\r\n                &lt;shortname&gt;academic&lt;/shortname&gt;\r\n                &lt;categoryName&gt;Academic&lt;/categoryName&gt;\r\n                &lt;state&gt;Yes&lt;/state&gt;\r\n            &lt;/category&gt;\r\n            &lt;category&gt;\r\n                &lt;categoryId&gt;2&lt;/categoryId&gt;\r\n                &lt;shortname&gt;administrative&lt;/shortname&gt;\r\n                &lt;categoryName&gt;Administrative&lt;/categoryName&gt;\r\n                &lt;state&gt;Yes&lt;/state&gt;\r\n            &lt;/category&gt;\r\n        &lt;/categories&gt;\r\n        \r\n\r\n2.  Buildings \r\n    1.  Endpoint \r\n        1.  `http://citl.gwu.edu/iphonedev/maps/[shortname].xml`\r\n    2.  Returns\r\n    \r\n        &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;\r\n        &lt;buildings xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;\r\n            &lt;building&gt;\r\n                &lt;buildingNumber&gt;153&lt;/buildingNumber&gt;\r\n                &lt;campus&gt;Foggy Bottom&lt;/campus&gt;\r\n                &lt;UsageClassification&gt;Academic&lt;/UsageClassification&gt;\r\n                &lt;buildingName&gt;1776 G St&lt;/buildingName&gt;\r\n                &lt;address&gt;1776 G St&lt;/address&gt;\r\n                &lt;geoLocation&gt;38.897984,-77.04146&lt;/geoLocation&gt;\r\n                &lt;shortname&gt;NA&lt;/shortname&gt;\r\n                &lt;picturelink&gt;http://www.gwu.edu/~newsctr/mobile/images/maps/1776-G-ST_UP_WLA_2010-6618.jpg&lt;/picturelink&gt;\r\n            &lt;/building&gt;\r\n            &lt;building&gt;\r\n                &lt;buildingNumber&gt;136&lt;/buildingNumber&gt;\r\n                &lt;campus&gt;Foggy Bottom&lt;/campus&gt;\r\n                &lt;UsageClassification&gt;Academic&lt;/UsageClassification&gt;\r\n                &lt;buildingName&gt;1957 E St&lt;/buildingName&gt;\r\n                &lt;address&gt;1957 E St&lt;/address&gt;\r\n                &lt;geoLocation&gt;38.896193,-77.044294&lt;/geoLocation&gt;\r\n                &lt;shortname&gt;1957E&lt;/shortname&gt;\r\n                &lt;picturelink&gt;http://www.gwu.edu/~newsctr/mobile/images/maps/Elliot_School_UP_WLA_2010-3102.jpg&lt;/picturelink&gt;\r\n            &lt;/building&gt;\r\n        &lt;/buildings&gt;\r\n        \r\n\r\n## API Wrapper\r\n\r\n1.  Source \r\n        class gw_api {\r\n        \r\n            public function __construct() {\r\n        \r\n                //configuration settings\r\n                $this-&gt;user_agent = 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_0 like Mac OS X; en-us) AppleWebKit/532.9 (KHTML, like Gecko) Version/4.0.5 Mobile/8A293 Safari/6531.22.7';\r\n                $this-&gt;maps_base = 'http://citl.gwu.edu/iphonedev/maps/';\r\n                $this-&gt;schedule_base = 'http://my.gwu.edu/mod/pws/scheduleXML.cfm';\r\n            }\r\n        \r\n            public function get_url($url) {\r\n        \r\n                //prefer the WP HTTP API to allow for caching and user agent spoofing, fall back if necessary\r\n                if ( function_exists( 'wp_remote_get') )\r\n                    $data = wp_remote_retrieve_body( wp_remote_get($url, array('user-agent' =&gt; $this-&gt;user_agent) ) );\r\n                else\r\n                    $data = file_get_contents($url);\r\n        \r\n                //parse the XML into a PHP object\r\n                $xml = simplexml_load_string($data, 'SimpleXMLElement', LIBXML_NOCDATA);\r\n        \r\n                return $xml;\r\n            }\r\n        \r\n            public function get_map($category = 'categories') {\r\n                return $this-&gt;get_url($this-&gt;maps_base . $category . '.xml');\r\n            }\r\n        \r\n            public function get_schedule($year = '', $term ='', $dept = ''){\r\n        \r\n                //if no year was given, assume the current year\r\n                if ($year == '')\r\n                    $year = date('Y');\r\n        \r\n                //if no term is given, calculate the current term\r\n                if ($term == '')\r\n                    $term = $this-&gt;get_term();\r\n        \r\n                //form URL and call\r\n                return $this-&gt;get_url($this-&gt;schedule_base . '?termCode=' . $year . $term . '&amp;deptCode=' . $dept);\r\n            }\r\n        \r\n            public function get_term() {\r\n        \r\n                //get the current month as 01-12\r\n                $m = date('M');\r\n        \r\n                //if it is jan. - april, we're in the spring\r\n                if ($m &lt; 5)\r\n                    return '01';\r\n        \r\n                //if it's May - August, we're in the summer\r\n                else if ($m &lt; 9) {\r\n                    return '02';\r\n                }\r\n        \r\n                //otherwise, it's fall\r\n                else return '03';\r\n            }\r\n        \r\n        }\r\n        \r\n\r\n2.  Usage \r\n    1.  Initialize \r\n            $gwapi = new gw_api;\r\n    \r\n    2.  List Departments \r\n            $departments = $gwapi-&gt;get_schedule();\r\n            foreach ($departments as $department)\r\n                echo $department-&gt;departmentname . '&lt;br /&gt;';\r\n            \r\n    \r\n    3.  Get Course Schedule for Fall 2011 \r\n            $courses = $gwapi-&gt;get_schedule('2011','03','ACCY');\r\n    \r\n    4.  Get Course Schedule for current term \r\n            $courses = $gwapi-&gt;get_schedule(null,null,'ACCY');\r\n    \r\n    5.  Get map categories \r\n            $categories = $gwapi-&gt;get_map();\r\n    \r\n    6.  Get Buildings \r\n            $buildings = $gwapi-&gt;get_maps('academic');\r\n\r\n[Photo: [atomicbartbeans][7]]\r\n\r\n [1]: http://ben.balter.com/wp-content/uploads/2011/01/1430289931_beb7ff6428_b-300x225.jpg \"Course Schedule\"\r\n [2]: http://acadtech.gwu.edu/pages/gwmobile\r\n [3]: http://blog.jerodsanto.net/2009/06/sniff-your-iphones-network-traffic/\r\n [4]: https://github.com/benbalter/GW-API\r\n [5]: #comments\r\n [6]: http://ben.balter.com/contact/\r\n [7]: http://www.flickr.com/photos/atomicbartbeans/1430289931/","previous":"<p>Regardless of where one&#8217;s politics may fall on the WikiLeaks prosecution, one thing is becoming abundantly clear as a result: <em>Twitter is emerging as a champion of users&#8217; rights.</em></p>\n\n<p><img alt='' src='http://cdn.benbalter.com/wp-content/uploads/2011/01/order-300x131.jpg' />Federal prosecutors investigating the disclosure of classified state documents <a href='http://www.nytimes.com/2011/01/09/world/09wiki.html?partner=rss&amp;emc=rss'>served Twitter with a court order</a> demanding it turn over information pertaining to several of its users. While there is nothing particularly alarming about <a href='http://www.salon.com/news/opinion/glenn_greenwald/2011/01/07/twitter/subpoena.pdf'>the order</a>, <sup id='fnref:1'><a href='#fn:1' rel='footnote'>1</a></sup> the bigger news is that <a href='http://techcrunch.com/2011/01/07/twitter-informs-users-of-doj-wikileaks-court-order-didnt-have-to/'>Twitter fought back</a>, contesting the attached gag order that prevented the social networking service from informing its users of its compliance with the otherwise lawful request. <sup id='fnref:2'><a href='#fn:2' rel='footnote'>2</a></sup></p>\n\n<p>Twitter&#8217;s decision, arguably <a href='http://www.mediaaccess.org/2011/01/twitter-does-good-no-kidding/'>the first of its kind</a>, gave the targets of the order the time and legal cover necessary to pursue their own challenges in court. What is troubling, however, is that presumably other service providers, <a href='http://www.guardian.co.uk/media/2011/jan/08/wikileaks-calls-google-facebook-us-subpoenas'>such as Google and Facebook</a>, could have received similar requests and silently acquiesced to the government&#8217;s demands.</p>\n\n<p>While many companies, including <a href='http://www.google.com/intl/en/privacy/privacy-policy.html'>Google</a> and <a href='http://info.yahoo.com/privacy/us/yahoo/details.html'>Yahoo</a>, have a policy of informing users of such requests when legally permissible, in this case, Twitter&#8217;s contention of the gag order, and the resulting opportunity to pursue legal action it subsequently afforded its users, was somewhat heroic, at least by internet standards, and is a practice other firms should follow. By no means was Twitter obliged to spend time and money <sup id='fnref:3'><a href='#fn:3' rel='footnote'>3</a></sup> rocking the boat on what appears to be an undoubtedly troublesome, but otherwise <a href='http://www.nytimes.com/2011/01/10/business/media/10link.html?ref=wikileaks'>somewhat routine</a> request, but they did so anyway, and to their users&#8217; benefit. Wired put it best when <a href='http://www.wired.com/threatlevel/2011/01/twitter/'>they noted</a>, &#8221;<em>Twitter introduced a new feature last month without telling anyone about itâ€¦ Twitter beta-tested a spine.</em>&#8221;</p>\n\n<p>A user&#8217;s protection from government intrusion should not diminish depending on the medium chosen and even more importantly, should not be dependent on the heroics of a caped internet crusader. This holds especially true when the world&#8217;s top social media firms are seemingly at <a href='https://www.eff.org/deeplinks/2010/04/facebook-further-reduces-control-over-personal-information'>opposite ends</a> of the privacy spectrum. While it may be true that it is simply good business sense <sup id='fnref:4'><a href='#fn:4' rel='footnote'>4</a></sup> for service providers to <a href='http://www.wired.com/threatlevel/2010/04/emailprivacy-2/'>fight to ensure the privacy of its user&#8217;s data</a> so that potential customers continue to visit the site and use their service, as any former Google Wave user knows, beta features, regardless of how heroic, are <a href='http://news.cnet.com/8301-13860_3-20012698-56.html'>not services to be relied on</a>. For progress to continue to march users into the cloud, the <a href='http://docs.google.com/viewer?a=v&amp;q=cache:IYzfdrim0owJ:www.fletc.gov/training/programs/legal-division/downloads-articles-and-faqs/downloads/other/obtaining_electronic.pdf/download+&amp;hl=en&amp;gl=us&amp;pid=bl&amp;srcid=ADGEESgpYeTPUFAijEyb4BnY4_wzFLwSJmRNv8yL2ZD8EkhQTjt7oXv9kELuYHG7A202xJ9_MGwvgVDwjviAEh0zW76gZQAbieBYwR6cnNUyD83txcScrGTU0qDUME590QPAMej6hmSy&amp;sig=AHIEtbTf4jZconLMbkMO_hVK8xQ92bqZNQ'>ambiguities surrounding a user&#8217;s digital rights</a> must be resolved through <a href='http://www.nytimes.com/2011/01/10/technology/10privacy.html?_r=1&amp;hp'>a comprehensive CTRL-F5 of privacy law</a> by <a href='http://ben.balter.com/2011/01/04/the-files-in-the-computer/'>knowledgeable lawmakers</a> before we all <a href='http://techcrunch.com/2011/01/10/why-im-having-second-thoughts-about-the-wisdom-of-the-cloud/'>retreat to pen and paper</a> in the interest of privacy.</p>\n\n<p>Notes:</p>\n<div class='footnotes'><hr /><ol><li id='fn:1'>\n<p>As our interactions move increasingly online, <a href='http://ben.balter.com/2010/10/10/does-every-cloud-have-a-silver-lining/'>we can hardly be surprised</a> that law enforcement officers will seek supporting documents from digital rather than physical information stores. <em>See, e.g.,</em> <a href='http://blogs.forbes.com/kashmirhill/2011/01/04/google-m-for-murder-internet-search-history-of-killing-methods-helped-convict-husband-of-homicide/'>Google search history aiding murder convictions</a>, <a href='http://www.nytimes.com/2011/01/03/us/03prisoners.html'>Prisoners coordinating riots via Facebook events</a>. <span>25</span></p>\n<a href='#fnref:1' rev='footnote'>&#8617;</a></li><li id='fn:2'>\n<p>To be sure, the government&#8217;s request was <a href='http://news.cnet.com/8301-31921_3-20027893-281.html'>far from a demand for specific, targeted information</a>, but rather suggested that prosecutors unfamiliar with <em>what exactly it is kids do these days</em> were simply casting as wide a net as legally permissible. Beyond <a href='http://www.salon.com/news/opinion/glenn_greenwald/2011/01/07/twitter/index.html'>misspelling the name of one of its targets</a>, the order, a <a href='http://www.law.cornell.edu/uscode/18/usc_sec_18_00002703----000-.html'>2703(d)</a> order, <a href='http://mashable.com/2011/01/08/twitter-subpoenaed-by-u-s-government-for-wikileaks-accounts/'>requested</a> credit card, banking information, and street addresses (information Twitter would obviously not be privy to as a free, web-based service) be delivered via &#8221;<a href='http://www.salon.com/news/opinion/glenn_greenwald/2011/01/07/twitter/subpoena.pdf'>CD-ROM</a>&#8221;. More likely, <a href='http://paranoia.dubfire.net/2011/01/thoughts-on-doj-wikileakstwitter-court.html'>the feds were seeking metadata</a>, the non-content data automatically associated with a user whenever he or she interacts with the service, data such as the date, time, and network address of the computer used to post messages (which could potentially be traced back to an individual or at least a physical location). <span>31</span></p>\n<a href='#fnref:2' rev='footnote'>&#8617;</a></li><li id='fn:3'>\n<p>Some might argue that Twitter should be considered heroic simply for stimulating the demand side of an <a href='http://www.nytimes.com/2011/01/09/business/09law.html'>otherwise anemic legal economy</a>. <span>33</span></p>\n<a href='#fnref:3' rev='footnote'>&#8617;</a></li><li id='fn:4'>\n<p>This may only hold true in the short run. As Columbia Law professor Tim Wu points out in his book <em>The Master Switch</em>, AT&amp;T&#8217;s &#8221;<a href='https://www.eff.org/nsa/hepting'>secret rooms</a>&#8221; illustrate that the service provider often may be compelled to contribute to the government&#8217;s information gathering infrastructure in hopes of garnering more favorable regulatory treatment. <span>35</span></p>\n<a href='#fnref:4' rev='footnote'>&#8617;</a></li></ol></div>","content":"<p><img alt='' src='http://ben.balter.com/wp-content/uploads/2011/01/emphasis-screenshot.png' />The New York Times <a href='http://open.blogs.nytimes.com/2011/01/11/emphasis-update-and-source/'>recently open-sourced</a> their nifty wizardry which allows users to highlight and link to specific text within an article or post. In their own words:</p>\n\n<blockquote>\n<p>Emphasis provides dynamic paragraph-specific anchor links and the ability to highlight text in a document, all of which is made available in the URL hash so it can be emailed, bookmarked, or shared.</p>\n</blockquote>\n\n<p>I adapted the New York Time&#8217;s implementation into a three-line WordPress plugin for my own site, and it is available in the <a href='http://wordpress.org/extend/plugins/wp-emphasis/'>WordPress plugin repository</a> as a one-click install, if you would like to add it to your own.</p>\n\n<p>The &#8220;deep links&#8221; plugin allows for permalinking and highlighting of text on a paragraph and sentance level. No need to set anything up. Just install, tap shift twice, and start highlighting.</p>\n\n<p><em>See</em> <a href='http://open.blogs.nytimes.com/2011/01/11/emphasis-update-and-source/'>The New York Times post on the script</a> for syntax and more information on general usage or you can double tap the <em>shift</em> key right now to give it a try.</p>\n\n<p>Neat, huh? <a href='http://wordpress.org/extend/plugins/wp-emphasis/'>Download it</a> today.</p>\n\n<p><em>Enjoy using WP Emphasis? Feel free to <a href='http://ben.balter.com/donate/' title='Donate'>make a small donation</a> to support the software&#8217;s continued development.</em></p>\n\n<p><strong>Update (1/18):</strong> For an interesting perspective on the underlying technology and what it could mean for the net, <a href='http://zachseward.com/emphasis/'>Zach Seward&#8217;s take</a> is well worth the read.</p>"}