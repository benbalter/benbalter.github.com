# Next.js Migration TODO

## Metadata Files with Liquid Syntax

These files currently use Jekyll's Liquid templating and need to be migrated to Next.js:

### Files to Migrate (in `public/` directory)

1. ~~**press-feed.xml** (`public/press-feed.xml`)~~ ✅ **DONE**
   * RSS feed for press clips
   * ~~Uses Liquid to iterate over `site.data.clips`~~
   * ~~Has front matter with `permalink: /press/feed/index.xml`~~
   * Implemented: `app/press/feed/index.xml/route.ts` using `generatePressFeed()` from `lib/rss.ts`

2. ~~**humans.txt** (`public/humans.txt`)~~ ✅ **DONE**
   * Credits file listing contributors
   * ~~Uses Liquid to iterate over `site.github.contributors` and `site.github.versions`~~
   * ~~Uses `site.time` for last updated date~~
   * Implemented: `app/humans.txt/route.ts` using `generateHumansTxt()` from `lib/metadata.ts`

3. ~~**robots.txt** (`public/robots.txt`)~~ ✅ **DONE**
   * Search engine crawler directives
   * ~~Uses Liquid to iterate over `page.disallows` array~~
   * ~~Has front matter defining disallow list~~
   * Implemented: Generated by `next-sitemap` during build

4. ~~**security.txt** (`public/security.txt`)~~ ✅ **DONE**
   * Security policy file (RFC 9116 compliant)
   * ~~Uses Liquid variables: `site.email`, `site.repository`, `page.url`~~
   * ~~Uses Liquid filters for date calculation and URL generation~~
   * ~~Has front matter with `permalink: .well-known/security.txt`~~
   * Implemented: `app/security.txt/route.ts` and `app/.well-known/security.txt/route.ts`

5. ~~**llms.txt** (`public/llms.txt`)~~ ✅ **DONE**
   * LLM/AI assistant context file
   * ~~Uses Liquid to include site description and other metadata~~
   * Implemented: `app/llms.txt/route.ts` using `generateLlmsTxt()` from `lib/metadata.ts`

6. ~~**browserconfig.xml** (`public/browserconfig.xml`)~~ ✅ **DONE**
   * Windows tile configuration for pinned sites
   * ~~Uses Liquid to generate tile image URL with build revision~~
   * ~~Has front matter with `sitemap: false`~~
   * Implemented: `app/browserconfig.xml/route.ts` using `generateBrowserconfigXml()` from `lib/metadata.ts`

### Migration Strategy

All metadata files have been successfully migrated using Next.js route handlers with `dynamic = 'force-static'` for static site generation.

### ~~Implementation Notes~~ (Completed)

The following patterns were used:

1. **Route handlers with static export**: Files are generated at `app/{filename}/route.ts` using:
   ```typescript
   export const dynamic = 'force-static';
   export async function GET() {
     const content = generateContent();
     return new Response(content, {
       headers: { 'Content-Type': 'text/plain; charset=utf-8' }
     });
   }
   ```

2. **Centralized generators**: Content generation functions are in `lib/metadata.ts` and `lib/rss.ts`

3. **XML feeds**: Use `application/rss+xml` or `application/xml` content types

## Open Graph Images

The `/public/assets/images/og/` directory contains 184 Open Graph images for posts. These were excluded from the initial migration to reduce diff size.

### TODO

* Copy OG images from Jekyll `assets/images/og/` to Next.js `public/assets/images/og/`
* Ensure post metadata correctly references OG images
* Verify images are accessible in production build
* Consider generating OG images dynamically using `@vercel/og` or similar

## Other Migration Tasks

* ~~Migrate any remaining Jekyll plugins to Next.js equivalents~~ ✅ Core plugins migrated
* ~~Set up RSS feed generation for blog posts~~ ✅ `feed.xml` generated via `script/generate-feeds.mjs`
* ~~Migrate sitemap generation logic~~ ✅ Using `next-sitemap`
* ~~Review and migrate any custom Jekyll filters or tags~~ ✅ Liquid processing via `lib/liquid.ts`
